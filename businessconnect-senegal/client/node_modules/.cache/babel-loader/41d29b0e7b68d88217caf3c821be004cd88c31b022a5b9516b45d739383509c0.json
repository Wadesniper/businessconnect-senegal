{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Table,Button,Space,Modal,message,Upload,Card,Typography,Tag,Input,Form}from'antd';import{EditOutlined,UploadOutlined,InboxOutlined,SearchOutlined}from'@ant-design/icons';import{adminService}from'../../../services/adminService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Title,Text}=Typography;const{Dragger}=Upload;const{TextArea}=Input;const JobManagement=()=>{const[jobs,setJobs]=useState([]);const[loading,setLoading]=useState(true);const[pagination,setPagination]=useState({current:1,pageSize:10,total:0});const[searchText,setSearchText]=useState('');const[isModalVisible,setIsModalVisible]=useState(false);const[form]=Form.useForm();const fetchJobs=async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;let pageSize=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;try{setLoading(true);const response=await adminService.getJobs(page,pageSize);setJobs(response.data);setPagination({current:page,pageSize,total:response.total});}catch(error){message.error('Erreur lors du chargement des offres d\\'emploi');}finally{setLoading(false);}};useEffect(()=>{fetchJobs();},[]);const handleTableChange=pagination=>{fetchJobs(pagination.current,pagination.pageSize);};const handleStatusChange=async(jobId,newStatus)=>{try{await adminService.updateJob(jobId,{status:newStatus});message.success('Statut mis à jour avec succès');fetchJobs(pagination.current,pagination.pageSize);}catch(error){message.error('Erreur lors de la mise à jour du statut');}};const handleDelete=async jobId=>{Modal.confirm({title:'Êtes-vous sûr de vouloir supprimer cette offre ?',content:'Cette action est irréversible.',okText:'Oui',okType:'danger',cancelText:'Non',onOk:async()=>{try{await adminService.deleteJob(jobId);message.success('Offre supprimée avec succès');fetchJobs(pagination.current,pagination.pageSize);}catch(error){message.error('Erreur lors de la suppression');}}});};const handleImport=async file=>{try{await adminService.importJobsFromFile(file);message.success('Import réussi');fetchJobs(pagination.current,pagination.pageSize);return false;// Prevent default upload behavior\n}catch(error){message.error('Erreur lors de l\\'import');return false;}};const handleCreateJob=async values=>{try{await adminService.createJob(values);message.success('Offre créée avec succès');setIsModalVisible(false);form.resetFields();fetchJobs(pagination.current,pagination.pageSize);}catch(error){message.error('Erreur lors de la création de l\\'offre');}};const columns=[{title:'Titre',dataIndex:'title',key:'title'},{title:'Entreprise',dataIndex:'company',key:'company'},{title:'Lieu',dataIndex:'location',key:'location'},{title:'Type',dataIndex:'type',key:'type',render:type=>/*#__PURE__*/_jsx(Tag,{color:\"blue\",children:type})},{title:'Statut',dataIndex:'status',key:'status',render:status=>/*#__PURE__*/_jsx(Tag,{color:status==='active'?'green':status==='expired'?'red':'orange',children:status})},{title:'Date de création',dataIndex:'createdAt',key:'createdAt',render:date=>new Date(date).toLocaleDateString()},{title:'Candidatures',dataIndex:'applications',key:'applications'},{title:'Actions',key:'actions',render:(_,record)=>/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:record.status==='active'?'default':'primary',onClick:()=>handleStatusChange(record.id,record.status==='active'?'inactive':'active'),children:record.status==='active'?'Désactiver':'Activer'}),/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>{form.setFieldsValue(record);setIsModalVisible(true);},children:\"Modifier\"}),/*#__PURE__*/_jsx(Button,{danger:true,onClick:()=>handleDelete(record.id),children:\"Supprimer\"})]})}];const filteredJobs=jobs.filter(job=>job.title.toLowerCase().includes(searchText.toLowerCase())||job.company.toLowerCase().includes(searchText.toLowerCase()));return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",size:\"large\",style:{width:'100%'},children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Title,{level:4,children:\"Import d'offres par lot\"}),/*#__PURE__*/_jsx(Text,{children:\"Importez plusieurs offres d'emploi \\xE0 partir d'un fichier Word (.docx)\"}),/*#__PURE__*/_jsxs(Dragger,{accept:\".docx\",beforeUpload:file=>handleImport(file),showUploadList:false,children:[/*#__PURE__*/_jsx(\"p\",{className:\"ant-upload-drag-icon\",children:/*#__PURE__*/_jsx(InboxOutlined,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"ant-upload-text\",children:\"Cliquez ou glissez-d\\xE9posez un fichier Word ici\"}),/*#__PURE__*/_jsx(\"p\",{className:\"ant-upload-hint\",children:\"Le fichier doit suivre le format sp\\xE9cifi\\xE9 dans le mod\\xE8le\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:16},children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(UploadOutlined,{}),onClick:()=>setIsModalVisible(true),children:\"Nouvelle offre\"}),/*#__PURE__*/_jsx(Input,{placeholder:\"Rechercher une offre...\",prefix:/*#__PURE__*/_jsx(SearchOutlined,{}),value:searchText,onChange:e=>setSearchText(e.target.value),style:{width:300}})]})}),/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:filteredJobs,loading:loading,rowKey:\"id\",pagination:pagination,onChange:handleTableChange}),/*#__PURE__*/_jsx(Modal,{title:\"Offre d'emploi\",visible:isModalVisible,onCancel:()=>{setIsModalVisible(false);form.resetFields();},footer:null,children:/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:handleCreateJob,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"title\",label:\"Titre\",rules:[{required:true,message:'Le titre est requis'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"company\",label:\"Entreprise\",rules:[{required:true,message:'L\\'entreprise est requise'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"location\",label:\"Lieu\",rules:[{required:true,message:'Le lieu est requis'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"type\",label:\"Type de contrat\",rules:[{required:true,message:'Le type de contrat est requis'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"description\",label:\"Description\",rules:[{required:true,message:'La description est requise'}],children:/*#__PURE__*/_jsx(TextArea,{rows:4})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"Enregistrer\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>{setIsModalVisible(false);form.resetFields();},children:\"Annuler\"})]})})]})})]})});};export default JobManagement;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}