{"ast":null,"code":"import React,{useState}from'react';import{Steps,Button,message,Layout,Typography,Spin}from'antd';import TemplateSelection from'./components/TemplateSelection';import CVForm from'./components/CVForm';import CustomizationForm from'./components/CustomizationForm';import CVPreview from'./components/CVPreview';import{CVProvider,useCV}from'./context/CVContext';import{exportCV}from'./services/documentExport';import{useSubscription}from'../../hooks/useSubscription';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Content}=Layout;const{Title:AntTitle}=Typography;const steps=[{title:'Modèle',description:'Choisissez votre template'},{title:'Informations',description:'Remplissez vos informations'},{title:'Personnalisation',description:'Personnalisez le design'},{title:'Aperçu & Export',description:'Prévisualisez et exportez'}];const CVGeneratorContent=_ref=>{let{isSubscribed}=_ref;const{cvData,setCVData,selectedTemplate,setSelectedTemplate,customization,setCustomization,currentStep,setCurrentStep,isValid}=useCV();const previewRef=React.useRef(null);const[isExporting,setIsExporting]=useState(false);const handleNext=()=>{if(currentStep===0){if(!selectedTemplate){message.error('Veuillez sélectionner un modèle');return;}message.success('Template sélectionné avec succès !');}if(currentStep===1&&!isValid){message.error('Veuillez remplir correctement tous les champs obligatoires');return;}setCurrentStep(currentStep+1);};const handlePrev=()=>{setCurrentStep(currentStep-1);};const handleExport=async format=>{try{if(!isValid||!selectedTemplate||!previewRef.current){message.error('Veuillez remplir correctement tous les champs obligatoires avant l\\'export');return;}setIsExporting(true);await exportCV(cvData,selectedTemplate,customization,previewRef,format);message.success(`CV exporté avec succès en format ${format.toUpperCase()}`);}catch(error){message.error('Erreur lors de l\\'export : '+error.message);}finally{setIsExporting(false);}};const renderStepContent=()=>{if(isExporting){return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'50px'},children:[/*#__PURE__*/_jsx(Spin,{size:\"large\"}),/*#__PURE__*/_jsx(\"p\",{style:{marginTop:'20px'},children:\"Export en cours...\"})]});}switch(currentStep){case 0:return/*#__PURE__*/_jsx(TemplateSelection,{selected:selectedTemplate,onSelect:setSelectedTemplate});case 1:return/*#__PURE__*/_jsx(CVForm,{data:cvData,onChange:setCVData});case 2:return/*#__PURE__*/_jsx(CustomizationForm,{options:customization,onChange:setCustomization});case 3:return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{ref:previewRef,children:/*#__PURE__*/_jsx(CVPreview,{data:cvData,template:selectedTemplate,customization:customization,isSubscribed:isSubscribed})}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:20,display:'flex',gap:10},children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>handleExport('pdf'),loading:isExporting,children:\"Exporter en PDF\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>handleExport('docx'),loading:isExporting,children:\"Exporter en Word\"})]})]});default:return null;}};return/*#__PURE__*/_jsx(Layout,{style:{minHeight:'100vh',backgroundColor:'#fff'},children:/*#__PURE__*/_jsxs(Content,{style:{padding:'50px 50px 0',maxWidth:1200,margin:'0 auto'},children:[/*#__PURE__*/_jsx(AntTitle,{level:2,style:{textAlign:'center',marginBottom:40},children:\"Cr\\xE9ez votre CV professionnel\"}),/*#__PURE__*/_jsx(Steps,{current:currentStep,items:steps,style:{marginBottom:40}}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:40},children:renderStepContent()}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',marginBottom:50},children:[currentStep>0&&/*#__PURE__*/_jsx(Button,{onClick:handlePrev,children:\"Pr\\xE9c\\xE9dent\"}),currentStep<steps.length-1&&/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:handleNext,disabled:currentStep===0&&!selectedTemplate,children:\"Suivant\"})]})]})});};const CVGenerator=props=>{const{hasActiveSubscription,loading}=useSubscription();const navigate=useNavigate();React.useEffect(()=>{if(!loading&&!hasActiveSubscription){navigate('/subscription',{replace:true});}},[loading,hasActiveSubscription,navigate]);if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',marginTop:100},children:\"Chargement...\"});}return/*#__PURE__*/_jsx(CVProvider,{children:/*#__PURE__*/_jsx(CVGeneratorContent,{...props})});};export default CVGenerator;","map":{"version":3,"names":["React","useState","Steps","Button","message","Layout","Typography","Spin","TemplateSelection","CVForm","CustomizationForm","CVPreview","CVProvider","useCV","exportCV","useSubscription","useNavigate","jsx","_jsx","jsxs","_jsxs","Content","Title","AntTitle","steps","title","description","CVGeneratorContent","_ref","isSubscribed","cvData","setCVData","selectedTemplate","setSelectedTemplate","customization","setCustomization","currentStep","setCurrentStep","isValid","previewRef","useRef","isExporting","setIsExporting","handleNext","error","success","handlePrev","handleExport","format","current","toUpperCase","renderStepContent","style","textAlign","padding","children","size","marginTop","selected","onSelect","data","onChange","options","ref","template","display","gap","type","onClick","loading","minHeight","backgroundColor","maxWidth","margin","level","marginBottom","items","justifyContent","length","disabled","CVGenerator","props","hasActiveSubscription","navigate","useEffect","replace"],"sources":["C:/Users/babac/OneDrive/Bureau/businessconnect-senegal-main/businessconnect-senegal/client/src/pages/cv-generator/index.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Steps, Button, message, Layout, Typography, Spin } from 'antd';\nimport TemplateSelection from './components/TemplateSelection';\nimport CVForm from './components/CVForm';\nimport CustomizationForm from './components/CustomizationForm';\nimport CVPreview from './components/CVPreview';\nimport { CVProvider, useCV } from './context/CVContext';\nimport { exportCV } from './services/documentExport';\nimport { CVGeneratorProps } from './types/index';\nimport { useSubscription } from '../../hooks/useSubscription';\nimport { useNavigate } from 'react-router-dom';\n\nconst { Content } = Layout;\nconst { Title: AntTitle } = Typography;\n\nconst steps = [\n  {\n    title: 'Modèle',\n    description: 'Choisissez votre template'\n  },\n  {\n    title: 'Informations',\n    description: 'Remplissez vos informations'\n  },\n  {\n    title: 'Personnalisation',\n    description: 'Personnalisez le design'\n  },\n  {\n    title: 'Aperçu & Export',\n    description: 'Prévisualisez et exportez'\n  }\n];\n\nconst CVGeneratorContent: React.FC<CVGeneratorProps> = ({ isSubscribed }) => {\n  const {\n    cvData,\n    setCVData,\n    selectedTemplate,\n    setSelectedTemplate,\n    customization,\n    setCustomization,\n    currentStep,\n    setCurrentStep,\n    isValid\n  } = useCV();\n\n  const previewRef = React.useRef<HTMLDivElement>(null);\n  const [isExporting, setIsExporting] = useState(false);\n\n  const handleNext = () => {\n    if (currentStep === 0) {\n      if (!selectedTemplate) {\n        message.error('Veuillez sélectionner un modèle');\n        return;\n      }\n      message.success('Template sélectionné avec succès !');\n    }\n    if (currentStep === 1 && !isValid) {\n      message.error('Veuillez remplir correctement tous les champs obligatoires');\n      return;\n    }\n    setCurrentStep(currentStep + 1);\n  };\n\n  const handlePrev = () => {\n    setCurrentStep(currentStep - 1);\n  };\n\n  const handleExport = async (format: 'pdf' | 'docx') => {\n    try {\n      if (!isValid || !selectedTemplate || !previewRef.current) {\n        message.error('Veuillez remplir correctement tous les champs obligatoires avant l\\'export');\n        return;\n      }\n      \n      setIsExporting(true);\n      await exportCV(cvData!, selectedTemplate, customization, previewRef, format);\n      message.success(`CV exporté avec succès en format ${format.toUpperCase()}`);\n    } catch (error) {\n      message.error('Erreur lors de l\\'export : ' + (error as Error).message);\n    } finally {\n      setIsExporting(false);\n    }\n  };\n\n  const renderStepContent = () => {\n    if (isExporting) {\n      return (\n        <div style={{ textAlign: 'center', padding: '50px' }}>\n          <Spin size=\"large\" />\n          <p style={{ marginTop: '20px' }}>Export en cours...</p>\n        </div>\n      );\n    }\n\n    switch (currentStep) {\n      case 0:\n        return (\n          <TemplateSelection\n            selected={selectedTemplate}\n            onSelect={setSelectedTemplate}\n          />\n        );\n      case 1:\n        return (\n          <CVForm\n            data={cvData}\n            onChange={setCVData}\n          />\n        );\n      case 2:\n        return (\n          <CustomizationForm\n            options={customization}\n            onChange={setCustomization}\n          />\n        );\n      case 3:\n        return (\n          <div>\n            <div ref={previewRef}>\n              <CVPreview\n                data={cvData!}\n                template={selectedTemplate!}\n                customization={customization}\n                isSubscribed={isSubscribed}\n              />\n            </div>\n            <div style={{ marginTop: 20, display: 'flex', gap: 10 }}>\n              <Button \n                type=\"primary\" \n                onClick={() => handleExport('pdf')}\n                loading={isExporting}\n              >\n                Exporter en PDF\n              </Button>\n              <Button \n                onClick={() => handleExport('docx')}\n                loading={isExporting}\n              >\n                Exporter en Word\n              </Button>\n            </div>\n          </div>\n        );\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Layout style={{ minHeight: '100vh', backgroundColor: '#fff' }}>\n      <Content style={{ padding: '50px 50px 0', maxWidth: 1200, margin: '0 auto' }}>\n        <AntTitle level={2} style={{ textAlign: 'center', marginBottom: 40 }}>\n          Créez votre CV professionnel\n        </AntTitle>\n\n        <Steps\n          current={currentStep}\n          items={steps}\n          style={{ marginBottom: 40 }}\n        />\n\n        <div style={{ marginBottom: 40 }}>\n          {renderStepContent()}\n        </div>\n\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 50 }}>\n          {currentStep > 0 && (\n            <Button onClick={handlePrev}>\n              Précédent\n            </Button>\n          )}\n          {currentStep < steps.length - 1 && (\n            <Button \n              type=\"primary\" \n              onClick={handleNext}\n              disabled={currentStep === 0 && !selectedTemplate}\n            >\n              Suivant\n            </Button>\n          )}\n        </div>\n      </Content>\n    </Layout>\n  );\n};\n\nconst CVGenerator: React.FC<Partial<CVGeneratorProps>> = (props) => {\n  const { hasActiveSubscription, loading } = useSubscription();\n  const navigate = useNavigate();\n\n  React.useEffect(() => {\n    if (!loading && !hasActiveSubscription) {\n      navigate('/subscription', { replace: true });\n    }\n  }, [loading, hasActiveSubscription, navigate]);\n\n  if (loading) {\n    return <div style={{ textAlign: 'center', marginTop: 100 }}>Chargement...</div>;\n  }\n\n  return (\n    <CVProvider>\n      <CVGeneratorContent {...props} />\n    </CVProvider>\n  );\n};\n\nexport default CVGenerator; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}