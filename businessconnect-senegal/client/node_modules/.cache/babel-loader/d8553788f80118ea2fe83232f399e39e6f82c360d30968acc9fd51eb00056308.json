{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{useParams,useNavigate}from'react-router-dom';import{Layout,Card,Row,Col,Typography,Space,Button,Image,Divider,Tag,Modal,Form,Input,message,Carousel,Select}from'antd';import{EnvironmentOutlined,EuroOutlined,MailOutlined,PhoneOutlined,ArrowLeftOutlined,EditOutlined,DeleteOutlined}from'@ant-design/icons';import{marketplaceService}from'../../services/marketplaceService';import{authService}from'../../services/authService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const{Title,Text,Paragraph}=Typography;const{Content}=Layout;const MarketplaceItemPage=()=>{const{id}=useParams();const navigate=useNavigate();const[item,setItem]=useState(null);const[loading,setLoading]=useState(true);const[isModalVisible,setIsModalVisible]=useState(false);const[form]=Form.useForm();const[isOwner,setIsOwner]=useState(false);const fetchItem=useCallback(async()=>{if(!id)return;setLoading(true);try{const data=await marketplaceService.getItem(id);if(data){setItem(data);const user=authService.getCurrentUser();setIsOwner((user===null||user===void 0?void 0:user.id)===data.userId);}}catch(error){message.error('Erreur lors de la récupération de l\\'annonce');}setLoading(false);},[id]);useEffect(()=>{fetchItem();},[fetchItem]);const handleUpdate=async values=>{if(!id)return;try{await marketplaceService.updateItem(id,values);message.success('Annonce mise à jour avec succès');setIsModalVisible(false);fetchItem();}catch(error){message.error('Erreur lors de la mise à jour de l\\'annonce');}};const handleDelete=async()=>{if(!id)return;try{await marketplaceService.deleteItem(id);message.success('Annonce supprimée avec succès');navigate('/marketplace');}catch(error){message.error('Erreur lors de la suppression de l\\'annonce');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Chargement...\"});}if(!item){return/*#__PURE__*/_jsx(\"div\",{children:\"Annonce non trouv\\xE9e\"});}return/*#__PURE__*/_jsx(Layout,{style:{padding:'24px'},children:/*#__PURE__*/_jsxs(Content,{children:[/*#__PURE__*/_jsxs(Row,{gutter:[24,24],children:[/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(ArrowLeftOutlined,{}),onClick:()=>navigate('/marketplace'),style:{marginBottom:16},children:\"Retour\"})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Row,{gutter:[24,24],children:[/*#__PURE__*/_jsx(Col,{xs:24,md:12,children:item.images.length>0?/*#__PURE__*/_jsx(Carousel,{autoplay:true,children:item.images.map((image,index)=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Image,{src:image,alt:`${item.title} - Image ${index+1}`,style:{width:'100%',height:400,objectFit:'cover'}})},index))}):/*#__PURE__*/_jsx(\"div\",{style:{height:400,background:'#f0f0f0',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsx(Text,{children:\"Aucune image\"})})}),/*#__PURE__*/_jsx(Col,{xs:24,md:12,children:/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(Title,{level:2,children:item.title}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Tag,{color:\"blue\",children:item.category}),/*#__PURE__*/_jsx(Tag,{color:item.status==='active'?'green':'red',children:item.status==='active'?'Disponible':'Vendu'})]}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(EuroOutlined,{}),/*#__PURE__*/_jsx(Text,{strong:true,style:{fontSize:'1.5em'},children:item.price})]}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(EnvironmentOutlined,{}),/*#__PURE__*/_jsx(Text,{children:item.location})]}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(Title,{level:4,children:\"Description\"}),/*#__PURE__*/_jsx(Paragraph,{children:item.description}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(Title,{level:4,children:\"Contact\"}),/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",children:[/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(MailOutlined,{}),/*#__PURE__*/_jsx(Text,{children:item.contactInfo.email})]}),item.contactInfo.phone&&/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(PhoneOutlined,{}),/*#__PURE__*/_jsx(Text,{children:item.contactInfo.phone})]})]}),isOwner&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>{form.setFieldsValue(item);setIsModalVisible(true);},children:\"Modifier\"}),/*#__PURE__*/_jsx(Button,{danger:true,icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),onClick:handleDelete,children:\"Supprimer\"})]})]})]})})]})})})]}),/*#__PURE__*/_jsx(Modal,{title:\"Modifier l'annonce\",open:isModalVisible,onCancel:()=>setIsModalVisible(false),footer:null,children:/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:handleUpdate,initialValues:item,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"title\",label:\"Titre\",rules:[{required:true,message:'Veuillez saisir un titre'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"description\",label:\"Description\",rules:[{required:true,message:'Veuillez saisir une description'}],children:/*#__PURE__*/_jsx(Input.TextArea,{rows:4})}),/*#__PURE__*/_jsx(Form.Item,{name:\"price\",label:\"Prix\",rules:[{required:true,message:'Veuillez saisir un prix'}],children:/*#__PURE__*/_jsx(Input,{type:\"number\",prefix:/*#__PURE__*/_jsx(EuroOutlined,{})})}),/*#__PURE__*/_jsx(Form.Item,{name:\"status\",label:\"Statut\",rules:[{required:true,message:'Veuillez sélectionner un statut'}],children:/*#__PURE__*/_jsxs(Select,{children:[/*#__PURE__*/_jsx(Select.Option,{value:\"active\",children:\"Disponible\"}),/*#__PURE__*/_jsx(Select.Option,{value:\"sold\",children:\"Vendu\"})]})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"Enregistrer les modifications\"})})]})})]})});};export default MarketplaceItemPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}